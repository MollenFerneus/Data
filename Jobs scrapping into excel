import json
import requests
from openpyxl import Workbook # import Workbook class from module openpyxl


api_url="https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBM-DA0321EN-SkillsNetwork/labs/module%201/Accessing%20Data%20Using%20APIs/jobs.json"
def get_number_of_jobs_T(technology):
    number_of_jobs = 0
    response = requests.get(api_url)
    if response.ok:             
        data = response.json()
    for jobs in data:
        skills = jobs.get('Key Skills')
        if technology in skills:
            number_of_jobs = number_of_jobs + 1
            
    
    
    return number_of_jobs


tname = input('Enter the Key Skill: ')

tcount = get_number_of_jobs_T(tname)

       
wb=Workbook()                        # create a workbook object
ws=wb.active                         # use the active worksheet
ws.append(['Technology', 'Number of Jobs'])   # add a row with two columns 'Technology' and 'Number of Jobs'
ws.append([str(tname), str(tcount)])       # add a row with two columns input of 'get_number_of_jobs(technology)' and the result of 'get_number_of_jobs(technology)'

wb.save(r"D:/Programming/Jobs count.xlsx")            # save the workbook into a file called Jobs count.xlsx in the selected folder
